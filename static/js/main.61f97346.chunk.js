(this.webpackJsonpmemaker=this.webpackJsonpmemaker||[]).push([[0],{185:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=185},186:function(e,t){},310:function(e,t,n){},325:function(e,t){},326:function(e,t){},327:function(e,t){},328:function(e,t){},329:function(e,t){},330:function(e,t){},331:function(e,t,n){},332:function(e,t,n){},334:function(e,t,n){},335:function(e,t,n){},336:function(e,t,n){},337:function(e,t,n){},338:function(e,t,n){},339:function(e,t,n){},340:function(e,t,n){},341:function(e,t,n){},342:function(e,t,n){},347:function(e,t){},348:function(e,t){},356:function(e,t){},357:function(e,t,n){},358:function(e,t,n){},359:function(e,t,n){},362:function(e,t,n){"use strict";n.r(t);var a,c,r=n(15),i=n.n(r),s=n(136),o=n.n(s),u=(n(310),n(8)),l=n.n(u),d=n(11),b=n(5),h=n(25),j="DELETE_CANVAS_OBJECT",f="CREATE_CANVAS_OBJECT",v="UPDATE_CANVAS_OBJECT",O="SET_ACTIVE_OBJECT",p=n(34),g=n(364),m=n(56),x=n(135),w=n(250),_=n(17),y=n(67),N={objects:{},objectsList:[],activeObject:null},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f:return console.log("create canvas object"),console.log(e.objectsList),Object(p.a)(Object(p.a)({},e),{},{objects:Object(p.a)(Object(p.a)({},e.objects),{},Object(y.a)({},t.canvasObject.id,t.canvasObject)),objectsList:[].concat(Object(_.a)(e.objectsList),[t.canvasObject.id]),activeObject:t.canvasObject.id});case O:return Object(p.a)(Object(p.a)({},e),{},{activeObject:t.id});case v:return Object(p.a)(Object(p.a)({},e),{},{objects:Object(p.a)(Object(p.a)({},e.objects),{},Object(y.a)({},t.id,Object(p.a)(Object(p.a)({},e.objects[t.id]),t.canvasObject)))});case j:return Object(p.a)(Object(p.a)({},e),{},{objects:Object(p.a)(Object(p.a)({},e.objects),{},Object(y.a)({},t.payload,Object(p.a)(Object(p.a)({},e.objects[t.payload]),{},{deleted:!0}))),activeObject:e.activeObject==t.payload?null:e.activeObject,objectsList:e.objectsList.filter((function(e){return e!==t.payload}))});default:return e}},C="SET_CANVAS_DIMENSIONS",E="SET_CANVAS_MAX_DIMENSIONS",S="SET_BACKGROUND_IMAGE",M="SET_SHOW_IMAGE_OVERLAY",I="TRIGGER_RERENDER",L="CLEAR_CANVAS",z={dimensions:{width:600,height:400},maxDimensions:{width:600,height:400},backgroundImage:null,showChoseBackgroundOverlay:!0,renderToggle:!1},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case I:return Object(p.a)(Object(p.a)({},e),{},{renderToggel:!e.renderToggle});case C:return Object(p.a)(Object(p.a)({},e),{},{dimensions:t.payload});case S:return Object(p.a)(Object(p.a)({},e),{},{dimensions:{width:t.payload.width,height:t.payload.height},backgroundImage:t.payload.image,showChoseBackgroundOverlay:!1});case E:return Object(p.a)(Object(p.a)({},e),{},{maxDimensions:t.payload});case L:return Object(p.a)(Object(p.a)({},e),{},{backgroundImage:null});case M:return console.log("change show"),Object(p.a)(Object(p.a)({},e),{},{showChoseBackgroundOverlay:t.payload});default:return e}},R=Object(x.b)({canvasObjects:k,canvas:T}),B=Object(x.c)(R,Object(x.a)(w.a)),D=n(7),A=n(39),F=n(38),P=(n(324),function(e){Object(A.a)(n,e);var t=Object(F.a)(n);function n(e){var a;return Object(D.a)(this,n),(a=t.call(this)).setObjectData=function(e){a.object=e,a.cachedObject=JSON.stringify(a.object)},a.shouldUpdate=function(e){return JSON.stringify(e)!==a.cachedObject},a.getData=function(){return a.object},a.update=function(e){a.shouldUpdate(e)&&(a.setObjectData(e),a.updateBaseProperties(e),a.updateObject(e))},a.updateBaseProperties=function(e){a.x=e.x,a.y=e.y,a.rotation=e.rotation||0},a.updateObject=function(e){},a.getWidth=function(){return a.width},a.getHeight=function(){return a.height},a.object=e,a.cachedObject=JSON.stringify(a.object),a.x=e.x?e.x:0,a.y=e.y?e.y:0,a}return n}(m.b)),W=function(e){Object(A.a)(n,e);var t=Object(F.a)(n);function n(e){var a;return Object(D.a)(this,n),(a=t.call(this,e)).updateObject=function(e){a.text.style.wordWrap=!0,a.text.style.wordWrapWidth=e.width,a.background.width=e.width,a.background.height=e.height,a.text.style.fill=e.color?m.f.string2hex(e.color):0,a.text.style.stroke=e.borderColor?m.f.string2hex(e.borderColor):0,a.text.style.strokeThickness=(null===e||void 0===e?void 0:e.borderWidth)||0,a.text.style.fontSize=(null===e||void 0===e?void 0:e.fontSize)||32,a.pivot.set(e.width/2,e.height/2)},a.textContent=e.text,a.text=new m.e(a.textContent),a.background=new m.c,a.background.beginFill(16711680),a.background.drawRect(0,0,a.text.width,a.text.height),a.background.endFill(),a.mask=a.background,a.updateObject(e),a.addChild(a.background,a.text),a}return n}(P),H=function(e){Object(A.a)(n,e);var t=Object(F.a)(n);function n(e){var a;return Object(D.a)(this,n),(a=t.call(this,e)).hasLoaded=function(){return new Promise((function(e,t){var n=0,c=setInterval((function(){console.log(a.sprite.width),1!==a.sprite.width&&(clearInterval(c),e()),n>=30&&(clearInterval(c),t()),n++}),20)}))},a.updateObject=function(e){a.sprite.width=e.width,a.sprite.height=e.height,e.flipHorizontal?(a.sprite.scale.x=-1*Math.abs(a.sprite.scale.x),a.sprite.anchor.x=1):(a.sprite.scale.x=Math.abs(a.sprite.scale.x),a.sprite.anchor.x=0),a.pivot.set(e.width/2,e.height/2)},a.getWidth=function(){return a.sprite.width},a.getHeight=function(){return a.sprite.height},a.sprite=m.d.from(e.src),a.addChild(a.sprite),a}return n}(P),U=function(e){Object(A.a)(n,e);var t=Object(F.a)(n);function n(e){var a;return Object(D.a)(this,n),(a=t.call(this,e)).update=function(e){if(console.log(e),console.log("update background"),a.background.width=e.dimensions.width,a.background.height=e.dimensions.height,console.log(a.background.height),e.backgroundImage!==a._sprite){if(null===e.backgroundImage)a.removeChild(a.sprite);else{console.log("insert new sprite"),a.removeChild(a.sprite),a.sprite=null;var t="/mememaker2.0"+e.backgroundImage;console.log("sprite data"),a.sprite=m.d.from(t),console.log(e.dimensions.width,e.dimensions.height),a.sprite.width=a.background.width,a.sprite.height=a.background.height,a.addChild(a.sprite)}a._sprite=e.backgroundImage}},a._sprite=null,a.sprite=null,a.background=new m.c,a.background.beginFill(16711680),a.background.drawRect(0,0,600,400),a.background.endFill(),a.addChild(a.background),a}return n}(m.b),V={},J="IMAGE_OBJECT",G="TEXT_OBJECT",X=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||!t.id||Q(t.id)){e.next=14;break}return e.next=3,Y(t);case 3:return(n=e.sent).interactive=!0,n.buttonMode=!0,n.zIndex=5,n.pivot.set(n.width/2,n.height/2),c=function(e){console.log("on item click!!!"),console.log(t.id),B.dispatch(ne(t.id))},n.on("mousedown",c).on("touchstart",c),a.stage.addChild(n),V[t.id]=n,console.log(V),e.abrupt("return",n);case 14:return e.abrupt("return",null);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.type,e.next=e.t0===J?3:e.t0===G?4:7;break;case 3:return e.abrupt("return",q(t));case 4:return e.next=6,K(t);case 6:return e.abrupt("return",e.sent);case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new H(t),e.next=3,n.hasLoaded();case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new W(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Q=function(e){return e in V};B.subscribe((function(){if(a){var e=B.getState(),t=e.canvasObjects,n=e.canvas,r=n.dimensions;i=r.width,s=r.height,a.view.width=i,a.view.height=s,console.log("resize canvas"),a.renderer.resize(i,s),Object.keys(t.objects).map((function(e){t.objects[e].deleted&&function(e){var t=V[e];a.stage.removeChild(t),V[e]=null}(e)})),c.update(n),function(e){var t=e.objects,n=e.objectsList;e.activeObject,n.forEach((function(e){if(console.log(e),Q(e)){var n=t[e];V[e].update(n)}}))}(t)}var i,s}));var Z=function(e){return{type:f,canvasObject:e}},$=function(e){return function(){var t=Object(d.a)(l.a.mark((function t(n){var a,c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e,a=Object(p.a)(Object(p.a)({fontSize:32,color:"#ffffff",boderColor:"#000000",borderWidth:3,wordWrap:!0,x:0,y:0,flipVertical:!1,flipHorizontal:!1,rotation:0},r),{},{id:Object(g.a)(),type:G}),t.next=3,X(a);case 3:c=t.sent,console.log("create text"),console.log(c),a.width=(null===c||void 0===c?void 0:c.getWidth())||100,a.height=(null===c||void 0===c?void 0:c.getHeight())||100,console.log("canvasText width"),console.log(null===c||void 0===c?void 0:c.getWidth()),n(Z(a));case 11:case"end":return t.stop()}var r}),t)})));return function(e){return t.apply(this,arguments)}}()},ee=function(e,t){var n=e.width,a=e.height;return n>t.width&&(a=t.width/n*a,n=t.width),a>t.height&&(n=t.height/a*n,a=t.height),{width:n,height:a}},te=function(e){return function(){var t=Object(d.a)(l.a.mark((function t(n){var a,c,r,i,s,o,u,d,b;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l=e,a=Object(p.a)(Object(p.a)({width:100,height:100,flipVertical:!1,flipHorizontal:!1,image:"",x:0,y:0,rotation:0},l),{},{id:Object(g.a)(),type:J}),t.next=3,X(a);case 3:c=t.sent,r=(null===c||void 0===c?void 0:c.getWidth())||100,i=(null===c||void 0===c?void 0:c.getHeight())||100,s=B.getState(),o=s.canvas.dimensions,u=ee({width:r,height:i},{width:o.width/2,height:o.height/2}),d=u.width,b=u.height,console.log(d,b),a.width=d,a.height=b,n(Z(a));case 13:case"end":return t.stop()}var l}),t)})));return function(e){return t.apply(this,arguments)}}()},ne=function(e){return{type:O,id:e}},ae=function(e,t){return{type:v,id:e,canvasObject:t}},ce=function(e,t){return{type:C,payload:{width:e,height:t}}},re=function(e,t,n){return{type:S,payload:{image:e,width:t,height:n}}},ie=function(e){return{type:M,payload:e}},se=function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var a=new Image;a.onload=function(){return e(a)},a.onerror=n,a.src=URL.createObjectURL(t)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oe=function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var a=new Image;a.onload=function(){return e(a)},a.onerror=n,a.src=t})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ue=function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){t.toBlob((function(t){e(t)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),le=n(97),de=(n(331),n(303)),be=(n(332),n(9)),he=function(e){var t=e.label,n=e.suffix,a=e.disabled,c=Object(de.a)(e,["label","suffix","disabled"]);return Object(be.jsxs)("div",{className:"input",children:[Object(be.jsx)("label",{className:"input__label",children:t}),Object(be.jsx)("input",Object(p.a)({className:"input__input",disabled:a},c)),Object(be.jsx)("div",{className:"input__type",children:n})]})},je=(n(334),function(){var e=Object(h.c)((function(e){return e.canvas.maxDimensions})),t=e.width,n=e.height;return{limit:function(e,a){return console.log(t,n),e>t&&(a*=t/e,e=t),a>n&&(console.log("fix height"),e*=n/a,a=n),{width:Math.round(e),height:Math.round(a)}},maxWidth:t,maxHeight:n}}),fe=function(){var e=Object(h.b)(),t=je(),n=t.limit,a=(t.maxWidth,t.maxHeight,Object(h.c)((function(e){return e.canvas.dimensions}))),c=a.width,r=a.height,i=Object(h.c)((function(e){return e.canvas.backgroundImage})),s=function(){var t=Object(d.a)(l.a.mark((function t(a){var c,r,i,s,o;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("load image"),!(c=a.target)||!c.files){t.next=8;break}return t.next=5,se(c.files[0]);case 5:r=t.sent,i=n(r.width,r.height),s=i.width,o=i.height,e(re(r.src,s,o));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(be.jsxs)("div",{className:"canvas-settings",children:[Object(be.jsx)("div",{className:"canvas-settings__img-container ".concat(i?"":"canvas-settings__img-container--clear"),children:Object(be.jsx)("img",{src:i})}),Object(be.jsxs)("div",{className:"canvas-settings__controlls",children:[Object(be.jsxs)("div",{className:"canvas-settings__dimensions",children:[Object(be.jsx)(he,{suffix:"px",label:"width",value:c,onChange:function(t){var n=t.target,a=parseInt(n.value);e(ce(a,r))},disabled:!!i}),Object(be.jsx)(he,{suffix:"px",label:"height",value:r,onChange:function(t){var n=t.target,a=parseInt(n.value);e(ce(c,a))},disabled:!!i})]}),Object(be.jsxs)("div",{className:"canvas-settings__buttons",children:[Object(be.jsxs)("label",{className:"canvas-settings__image-input",children:["Custom Image",Object(be.jsx)("input",{type:"file",accept:"image/*",name:"image",onChange:s})]}),Object(be.jsx)("button",{className:"canvas-settings__button",onClick:function(){e({type:L})},children:"Clear Backgorund"})]})]})]})},ve=[{name:"",path:"TwoButtons.png"},{name:"",path:"ChangeMyMind.png"},{name:"",path:"DistractedBoyfriend.png"},{name:"",path:"BatmanSlappingRobin.png"},{name:"",path:"BernieSupport.png"},{name:"",path:"BikeFall.png"},{name:"",path:"BuffDogeVS.png"},{name:"",path:"Draw25.png"},{name:"",path:"EpicHandshaker.png"},{name:"",path:"ExpandingBrain.png"},{name:"",path:"GrusPlan.png"},{name:"",path:"IsThisAPigeon.png"},{name:"",path:"LeftExitOffRamp.png"},{name:"",path:"MockingSpongebob.png"},{name:"",path:"OneDoesNotSimply.png"},{name:"",path:"RunningAwayBalloon.png"},{name:"",path:"SadPabloEscobar.png"}],Oe=(n(335),function(e){var t=e.template,n=e.onClick,a=function(e){return"/mememaker2.0/meme_templates/"+e.path}(t);return Object(be.jsx)("div",{className:"template-list__item",style:{backgroundImage:"url('".concat(a,"')")},title:t.name||t.path,onClick:function(){return n(a)}})}),pe=function(){var e=Object(h.b)(),t=Object(r.useRef)(null),n=je(),a=n.limit,c=(n.maxWidth,n.maxHeight,Object(r.useState)("")),i=Object(b.a)(c,2),s=i[0],o=i[1],u=Object(r.useState)(0),j=Object(b.a)(u,2),f=j[0],v=j[1],O=Object(r.useState)(14),p=Object(b.a)(O,2),g=p[0],m=(p[1],Object(r.useState)(1)),x=Object(b.a)(m,2),w=x[0],y=x[1],N=Object(r.useState)([]),k=Object(b.a)(N,2),C=k[0],E=k[1];Object(r.useEffect)((function(){!function(){var e=M(s);y(Math.ceil(e.length/g));var t=S(e,f,g);console.log(t),E(t)}()}),[s,f,g]);var S=function(e,t,n){var a=t*n,c=(t+1)*n;return e.slice(a,c>e.length?e.length:c)},M=function(e){return""===e?ve:ve.filter((function(t){var n=e.toLowerCase();return t.name.toLowerCase().includes(n)||t.path.toLowerCase().includes(n)}))},I=function(){var t=Object(d.a)(l.a.mark((function t(n){var c,r,i,s;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,oe(n);case 2:c=t.sent,r=a(c.width,c.height),i=r.width,s=r.height,e(re(n,i,s));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(be.jsxs)("div",{className:"template-list",children:[Object(be.jsx)("div",{className:"template-list__search-container",children:Object(be.jsx)("input",{className:"template-list__search",placeholder:"search...",value:s,onChange:function(e){var t=e.target.value;o(t)}})}),Object(be.jsx)("div",{className:"template-list__items",ref:t,children:C.length>0?C.map((function(e){return Object(be.jsx)(Oe,{template:e,onClick:I},e.path)})):Object(be.jsx)("div",{className:"template-list__message",children:"No templates found"})}),Object(be.jsx)("div",{className:"template-list__pagination",children:Object(_.a)(new Array(w)).map((function(e,t){return Object(be.jsx)("div",{className:"template-list__page-icon ".concat(t==f?"template-list__page-icon--active":""),onClick:function(){return v(t)},children:Object(be.jsx)("span",{children:t+1})},"page-".concat(t))}))})]})},ge=function(){var e=Object(h.b)(),t=Object(h.c)((function(e){return e.canvas.showChoseBackgroundOverlay}));console.log(t);return Object(be.jsx)("div",{className:"canvas-editor ".concat(t?"":"canvas-editor--closed"),children:Object(be.jsxs)("div",{className:"canvas-editor__container",children:[Object(be.jsxs)("header",{className:"canvas-editor__header",children:[Object(be.jsx)("h3",{children:"Canvas Settings"}),Object(be.jsx)("button",{className:"canvas-editor__close",onClick:function(){e(ie(!1))},children:Object(be.jsx)(le.c,{})})]}),Object(be.jsxs)("div",{className:"canvas-editor__body",children:[Object(be.jsx)(fe,{}),Object(be.jsx)(pe,{})]})]})})},me=(n(336),n(337),14),xe=function(e){var t=e.activeObject,n=e.container,a=Object(h.b)(),c=Object(r.useState)(!1),i=Object(b.a)(c,2),s=i[0],o=i[1];Object(r.useEffect)((function(){return document.addEventListener("mousemove",u,!1),function(){return document.removeEventListener("mousemove",u,!1)}}),[s]),Object(r.useEffect)((function(){return document.addEventListener("mouseup",l,!1),function(){return document.removeEventListener("mouseup",l,!1)}}),[s]);var u=function(e){if(s&&n){var c=n.current.getBoundingClientRect(),r=e.clientX-c.x,i=e.clientY-c.y,o=Math.atan2(i-t.y,r-t.x)+Math.PI/2;a(ae(t.id,{rotation:o}))}},l=function(){o(!1),document.body.style.cursor="default"};return Object(be.jsx)("div",{className:"active-object__rotation-handle",onPointerDown:function(){o(!0),document.body.style.cursor="grabbing"},style:{backgroundColor:s?"red":"#fff"}})},we=function(e){var t=e.x,n=e.y,a=e.cursor,c=e.size,i=e.container,s=e.activeObject,o=Object(r.useState)(!1),u=Object(b.a)(o,2),l=u[0],d=u[1],j=Object(h.b)();Object(r.useEffect)((function(){return document.addEventListener("mousemove",v,!1),function(){return document.removeEventListener("mousemove",v,!1)}}),[l]),Object(r.useEffect)((function(){return document.addEventListener("mouseup",f,!1),function(){return document.removeEventListener("mouseup",f,!1)}}),[l]);var f=function(){d(!1)},v=function(e){if(l&&i){var a=i.current.getBoundingClientRect(),c=e.clientX-a.x,r=e.clientY-a.y,o=(s.x,s.width,s.y,s.height,s.x-s.width/2+s.width*(1-t)),u=s.y-s.height/2+s.height*(1-n),d=function(e){return 1==e?1:-1},b=.5!==n?Math.max(d(n)*r-d(n)*u,30):s.height,h=.5!==t?Math.max(d(t)*c-d(t)*o,30):s.width,f=.5!==t?b/s.height*s.width:s.width,v=.5==n?h:f;s.type==G&&(v=h),console.log(o,u);var O=.5!==n?u+d(n)*b/2:s.y,p=.5!==t?o+d(t)*v/2:s.x;j(ae(s.id,{x:p,y:O,width:v,height:b}))}},O=-c/2-1;return Object(be.jsx)("div",{className:"active-object__handle",onPointerDown:function(){d(!0)},style:{width:c,height:c,cursor:a||"pointer",top:0==n?O:.5==n?"50%":void 0,left:0==t?O:.5==t?"50%":void 0,bottom:1==n?O:void 0,right:1==t?O:void 0,transform:.5===t?"translate(-50%, 0)":.5===n?"translate(0,-50%)":void 0}})},_e=function(e){var t=e.container,n=Object(h.b)(),a=Object(r.useState)(!1),c=Object(b.a)(a,2),i=c[0],s=c[1],o=Object(r.useState)({x:0,y:0}),u=Object(b.a)(o,2),l=u[0],d=u[1],j=Object(h.c)((function(e){return e.canvasObjects.activeObject})),f=Object(h.c)((function(e){return e.canvasObjects.objects})),v=j&&j in f?f[j]:null;Object(r.useEffect)((function(){return document.addEventListener("mousemove",p,!1),function(){return document.removeEventListener("mousemove",p,!1)}}),[i,t,v]);var O=function(e,t,n){return Math.min(Math.max(e,t),n)},p=function(e){if(i&&t){var a=t.current.getBoundingClientRect(),c=e.clientX-a.x-l.x,r=e.clientY-a.y-l.y,s=O(c,0,a.width),o=O(r,0,a.height);n(ae(j,{x:s,y:o}))}};return Object(be.jsxs)("div",{className:"active-object",style:{display:v?"block":"none",top:j?"".concat(v.y-10-v.height/2,"px"):0,left:j?"".concat(v.x-10-v.width/2,"px"):0,width:v?"".concat(v.width+20,"px"):100,height:v?"".concat(v.height+20,"px"):100,transformOrigin:"center center",transform:"rotate(".concat((null===v||void 0===v?void 0:v.rotation)||0,"rad)")},children:[Object(be.jsx)("div",{className:"active-object__content",onPointerDown:function(e){if(t){var n=t.current.getBoundingClientRect(),a=e.clientX-n.x-v.x,c=e.clientY-n.y-v.y;d({x:a,y:c}),s(!0)}},onPointerUp:function(){s(!1)}}),Object(be.jsx)(we,{x:0,y:0,size:me,cursor:"nw-resize",container:t,activeObject:v}),Object(be.jsx)(we,{x:.5,y:0,size:me,cursor:"n-resize",container:t,activeObject:v}),Object(be.jsx)(we,{x:1,y:0,size:me,cursor:"ne-resize",container:t,activeObject:v}),Object(be.jsx)(we,{x:1,y:.5,size:me,cursor:"e-resize",container:t,activeObject:v}),Object(be.jsx)(we,{x:1,y:1,size:me,cursor:"se-resize",container:t,activeObject:v}),Object(be.jsx)(we,{x:.5,y:1,size:me,cursor:"s-resize",container:t,activeObject:v}),Object(be.jsx)(we,{x:0,y:1,size:me,cursor:"sw-resize",container:t,activeObject:v}),Object(be.jsx)(we,{x:0,y:.5,size:me,cursor:"w-resize",container:t,activeObject:v}),Object(be.jsx)(xe,{activeObject:v,container:t})]})},ye=(n(338),function(){var e=Object(h.b)(),t=Object(r.useRef)(),n=Object(r.useRef)(),i=Object(h.c)((function(e){return e.canvas.dimensions})),s=i.width,o=i.height;Object(h.c)((function(e){return e.canvas.maxDimensions}));return Object(r.useLayoutEffect)((function(){function t(){var t=n.current.getBoundingClientRect();e(function(e,t){return{type:E,payload:{width:e,height:t}}}(Math.round(t.width),Math.round(t.height)))}return window.addEventListener("resize",t),t(),function(){return window.removeEventListener("resize",t)}}),[e]),Object(r.useEffect)((function(){!function(e){if(a)return null;a=new m.a({backgroundColor:16777215,resolution:1,preserveDrawingBuffer:!0}),e.appendChild(a.view),a.stage.sortableChildren=!0,c=new U,a.stage.addChild(c)}(t.current)}),[]),Object(be.jsx)("div",{ref:n,className:"canvas-area",children:Object(be.jsx)("div",{ref:t,className:"canvas-area__canvas",style:{width:s,height:o},children:Object(be.jsx)(_e,{container:t})})})}),Ne=(n(339),n(340),n(341),function(e){var t=e.children,n=e.className,a=e.onClick,c=e.disabled;return Object(be.jsx)("button",{className:"rainbow-button ".concat(n),onClick:a,disabled:c,children:t})}),ke=function(){var e=Object(h.b)(),t=Object(h.c)((function(e){return e.canvas.dimensions})),n=Object(r.useState)(""),a=Object(b.a)(n,2),c=a[0],i=a[1];return Object(be.jsxs)("div",{className:"text-creator",children:[Object(be.jsx)("div",{className:"text-creator__input-container",children:Object(be.jsx)("textarea",{className:"text-creator__input",value:c,onChange:function(e){var t=e.target.value;i(t)},placeholder:"Write Text..."})}),Object(be.jsx)(Ne,{className:"rainbow-button--fullsize mt",onClick:function(){e($({text:c,x:Math.round(t.width/2),y:Math.round(t.height/2)}))},disabled:!c,children:"Add Text"})]})},Ce=(n(342),n(251)),Ee=n(271),Se=(n(360),n(361),null),Me=null,Ie=function(){var e=Object(r.useRef)(null),t=Object(r.useState)([]),n=Object(b.a)(t,2),a=n[0],c=n[1],i=Object(r.useState)({message:"",time:null,isLoading:!1}),s=Object(b.a)(i,2),o=s[0],u=s[1],h=function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(j("loading models"),console.log("loading models..."),Se){e.next=6;break}return e.next=5,Ee.a();case 5:Se=e.sent;case 6:if(Me){e.next=10;break}return e.next=9,Ce.a({architecture:"MobileNetV1",outputStride:8,quantBytes:4});case 9:Me=e.sent;case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];u({message:e,time:t?new Date:null,isLoading:t})},f=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h();case 2:return e.next=4,v(t);case 4:n=e.sent,c(n),a=n.length>0?"Extracted Faces":"No Faces Found",j(a,!1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var t=Object(d.a)(l.a.mark((function t(n){var a,c,r,i;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.current){t.next=2;break}return t.abrupt("return",[]);case 2:return console.log("extract Faces"),j("searching for faces"),t.next=6,p(n);case 6:a=t.sent,console.log(a),c=[],r=0;case 10:if(!(r<a.length)){t.next=26;break}return j("extracting face ".concat(r+1)),t.next=14,O(e.current,n,a[r]);case 14:return t.next=16,g(e.current);case 16:return t.next=18,ue(e.current);case 18:(i=t.sent).name="".concat(n.name.split(".")[0],"-f-").concat(r,".png"),i.width=e.current.width,i.height=e.current.height,c.push(i);case 23:r++,t.next=10;break;case 26:return t.abrupt("return",c);case 27:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),O=function(){var e=Object(d.a)(l.a.mark((function e(t,n,a){var c,r,i,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.width=a.width,t.height=a.height,c=a.x,r=a.y,i=a.width,s=a.height,t.getContext("2d").drawImage(n,c,r,i,s,0,0,t.width,t.height);case 8:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),p=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a,c,r,i,s,o,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!1,e.next=3,Se.estimateFaces(t,false);case 3:if(n=e.sent,a=[],n.length>0)for(c=0;c<n.length;c++)r=n[c].topLeft,i=n[c].bottomRight,s=[i[0]-r[0],i[1]-r[1]],o=Math.max(r[1]-s[1]/1.3,0),u=Math.max(r[0]-s[0]/4,0),a.push({x:u,y:o,width:1.5*s[0],height:1.7*s[1]});return e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a,c,r,i,s,o,u,d,h,j,f,v,O,p;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Me.segmentPerson(t);case 2:for(n=e.sent,a=n.data,c=t.getContext("2d"),r=c.getImageData(0,0,t.width,t.height),i=r.data,s=c.createImageData(t.width,t.height),o=s.data,u=0;u<a.length;u++)d=[i[4*u],i[4*u+1],i[4*u+2],i[4*u+3]],h=d[0],j=d[1],f=d[2],v=d[3],O=a[u]?[h,j,f,v]:[255,255,255,0],p=Object(b.a)(O,4),o[4*u]=p[0],o[4*u+1]=p[1],o[4*u+2]=p[2],o[4*u+3]=p[3];c.putImageData(s,0,0);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{extractFaces:f,extractedFaces:a,canvasRef:e,status:o}},Le=function(e,t){var n=Object(r.useRef)();Object(r.useEffect)((function(){n.current=e}),[e]),Object(r.useEffect)((function(){if(null!==t){var e=setInterval((function(){n&&n.current&&n.current()}),t);return function(){return clearInterval(e)}}}),[t])},ze=function(e){var t=e.className,n=e.startDate,a=e.refreshRate,c=Object(r.useState)("00:00"),i=Object(b.a)(c,2),s=i[0],o=i[1];return Le((function(){console.log("interval");var e=n?function(e){var t=Math.floor(((new Date).getTime()-e.getTime())/1e3),n=Math.floor(t/60)%60,a=t%60;return"".concat(("0"+n).slice(-2),":").concat(("0"+a).slice(-2))}(n):"";o(e)}),a),Object(be.jsx)("div",{className:t,children:s})};ze.defaultProps={refreshRate:500};var Te=ze,Re=(n(357),function(e){var t=e.image,n=e.onChange,a=t?t.src:void 0;return Object(be.jsxs)("label",{className:"image-input",children:[Object(be.jsx)("input",{type:"file",accept:"image/*",name:"image",className:"image-input__input",onChange:n}),Object(be.jsxs)("div",{className:"image-input__background ".concat(t?"image-input__background--elevated":""),children:[Object(be.jsx)("div",{children:"Chose or drop file"}),Object(be.jsx)(le.b,{})]}),Object(be.jsx)("img",{className:"image-input__img",src:a})]})}),Be=function(){var e=Object(h.b)(),t=Object(h.c)((function(e){return e.canvas.dimensions})),n=Object(r.useState)(void 0),a=Object(b.a)(n,2),c=a[0],i=a[1],s=Ie(),o=s.canvasRef,u=s.status,j=s.extractedFaces,f=s.extractFaces,v=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("load image"),!(n=t.target)||!n.files){e.next=8;break}return e.next=5,se(n.files[0]);case 5:a=e.sent,console.log(a),i(a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=function(){var n=Object(d.a)(l.a.mark((function n(){return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:c&&e(te({src:c.src,x:Math.round(t.width/2),y:Math.round(t.height/2)}));case 1:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),p=function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c&&f(c);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(){var n=Object(d.a)(l.a.mark((function n(a,c){return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e(te({src:c,x:Math.round(t.width/2),y:Math.round(t.height/2)}));case 1:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}();return Object(be.jsxs)("div",{className:"image-creator",children:[Object(be.jsx)(Re,{image:c,onChange:v}),Object(be.jsx)(Ne,{className:"rainbow-button--fullsize mt",onClick:O,disabled:!c,children:"Add Image"}),Object(be.jsx)(Ne,{className:"rainbow-button--fullsize mt",onClick:p,disabled:!c,children:"Extract Faces"}),Object(be.jsxs)("div",{className:"image-creator__face-extractor",children:[Object(be.jsxs)("div",{className:"image-creator__status",children:[Object(be.jsx)(Te,{className:"image-creator__time",startDate:u.time}),Object(be.jsx)("div",{children:u.message})]}),Object(be.jsx)("div",{className:"image-creator__face-list",children:j.map((function(e){var t=window.URL.createObjectURL(e);return Object(be.jsx)("div",{className:"image-creator__face-item",onClick:function(){return g(e,t)},children:Object(be.jsx)("img",{src:t})})}))})]}),Object(be.jsx)("canvas",{ref:o,className:"image-creator__canvas"})]})},De={TEXT:"Text",IMAGE:"Image"},Ae=function(){var e=Object(r.useState)(De.TEXT),t=Object(b.a)(e,2),n=t[0],a=t[1];return Object(be.jsxs)("div",{className:"object-creator",children:[Object(be.jsx)("header",{className:"object-creator__header",children:Object.entries(De).map((function(e){var t=Object(b.a)(e,2),c=(t[0],t[1]);return Object(be.jsx)("button",{className:"object-creator__toggle-btn ".concat(n==c?"object-creator__toggle-btn--active":""),onClick:function(){return a(c)},children:c},c)}))}),Object(be.jsx)("div",{className:"object-creator__container",children:function(e){switch(e){case De.IMAGE:return Object(be.jsx)(Be,{});default:return Object(be.jsx)(ke,{})}}(n)})]})},Fe=function(){return Object(be.jsx)("div",{className:"ui-panel p flex-center",children:Object(be.jsx)(Ne,{className:"rainbow-button--fullsize",onClick:function(){if(a){console.log(a.view);var e=document.createElement("a");e.download="meme.png",e.href=a.view.toDataURL("image/png"),e.click()}},children:"Download"})})},Pe=function(e){var t=e.activeObject,n=Object(h.b)(),a=function(e){var a=e.target,c=a.name,r=a.value,i=parseInt(r)?parseInt(r):0;n(ae(t.id,Object(y.a)({},c,i)))},c=function(e){var a=e.target,c=a.name,r=a.value;n(ae(t.id,Object(y.a)({},c,r)))};return Object(be.jsxs)("div",{className:"editor",children:[Object(be.jsxs)("div",{className:"editor__row",children:[Object(be.jsx)(he,{label:"x:",suffix:"px",value:Math.round(t.x),name:"x",onChange:a}),Object(be.jsx)(he,{label:"y:",suffix:"px",value:Math.round(t.y),name:"y",onChange:a})]}),Object(be.jsxs)("div",{className:"editor__row",children:[Object(be.jsx)(he,{label:"width:",suffix:"px",value:Math.round(t.width),name:"width",onChange:a}),Object(be.jsx)(he,{label:"height:",suffix:"px",value:Math.round(t.height),name:"height",onChange:a})]}),Object(be.jsx)("div",{className:"editor__row",children:Object(be.jsx)(he,{label:"rotation:",suffix:"px",value:t.rotation,name:"rotation",onChange:a,type:"number"})}),Object(be.jsx)("div",{className:"editor__row",children:Object(be.jsx)(he,{label:"font size:",suffix:"px",value:t.fontSize,name:"fontSize",onChange:a,type:"number"})}),Object(be.jsx)("div",{className:"editor__row",children:Object(be.jsx)(he,{label:"color:",suffix:"",type:"color",value:t.color,name:"color",onChange:c})}),Object(be.jsx)("div",{className:"editor__row",children:Object(be.jsx)(he,{label:"border color:",suffix:"",type:"color",value:t.borderColor,name:"borderColor",onChange:c})}),Object(be.jsx)("div",{className:"editor__row",children:Object(be.jsx)(he,{label:"border width:",suffix:"px",value:t.borderWidth,name:"borderWidth",onChange:a})})]})},We=function(e){var t=e.activeObject,n=Object(h.b)(),a=function(e){var a=e.target,c=a.name,r=a.value,i=parseInt(r)?parseInt(r):0;n(ae(t.id,Object(y.a)({},c,i)))};return Object(be.jsxs)("div",{className:"editor",children:[Object(be.jsxs)("div",{className:"editor__row",children:[Object(be.jsx)(he,{label:"x:",suffix:"px",value:Math.round(t.x),name:"x",onChange:a}),Object(be.jsx)(he,{label:"y:",suffix:"px",value:Math.round(t.y),name:"y",onChange:a})]}),Object(be.jsxs)("div",{className:"editor__row",children:[Object(be.jsx)(he,{label:"width:",suffix:"px",value:Math.round(t.width),name:"width",onChange:a}),Object(be.jsx)(he,{label:"height:",suffix:"px",value:Math.round(t.height),name:"height",onChange:a})]}),Object(be.jsx)("div",{className:"editor__row",children:Object(be.jsx)(he,{label:"rotation:",suffix:"px",value:t.rotation,name:"rotation",onChange:a,type:"number"})}),Object(be.jsx)("div",{className:"editor__row",children:Object(be.jsx)(he,{label:"flip:",suffix:"",value:t.flipHorizontal,name:"flipHorizontal",onChange:function(e){console.log("flip");var a=e.target,c=a.name,r=(a.value,a.checked);n(ae(t.id,Object(y.a)({},c,r)))},type:"checkbox"})})]})},He=function(){var e=Object(h.c)((function(e){return e.canvasObjects.activeObject})),t=Object(h.c)((function(e){return e.canvasObjects.objects})),n=e&&e in t?t[e]:null;return Object(be.jsx)("div",{className:"ui-panel",children:function(){if(!e)return null;switch(n.type){case J:return Object(be.jsx)(We,{activeObject:n});case G:return Object(be.jsx)(Pe,{activeObject:n});default:return null}}()})},Ue=(n(358),function(e){var t=e.item,n=e.isActive,a=Object(h.b)();return Object(be.jsxs)("div",{className:"canvas-item ".concat(n?"canvas-item--active":""),onClick:function(e){a(ne(t.id))},children:[Object(be.jsx)("div",{className:"canvas-item__icon",children:function(){switch(t.type){case G:return Object(be.jsx)(le.a,{});case J:return Object(be.jsx)(le.b,{});default:return null}}()}),Object(be.jsx)("div",{className:"canvas-item__content",children:function(){switch(t.type){case G:return t.text;case J:default:return null}}()}),Object(be.jsx)("div",{className:"canvas-item__remove-btn",onClick:function(e){var n;e.stopPropagation(),a((n=t.id,{type:j,payload:n}))},children:Object(be.jsx)(le.d,{})})]})}),Ve=function(){Object(h.b)();var e=Object(h.c)((function(e){return e.canvasObjects.activeObject})),t=Object(h.c)((function(e){return e.canvasObjects.objects})),n=Object(h.c)((function(e){return e.canvasObjects.objectsList}));return Object(be.jsx)("div",{className:"ui-panel p canvas-object-list",children:n.map((function(n){var a=t[n];return Object(be.jsx)(Ue,{item:a,isActive:e===a.id},a.id)}))})},Je=function(){var e=Object(h.b)();return Object(be.jsx)("div",{className:"ui-panel p flex-center",children:Object(be.jsx)(Ne,{className:"rainbow-button--fullsize",onClick:function(){e(ie(!0))},children:"Edit Background"})})};var Ge=function(){Object(h.b)();var e=Object(r.useState)(null),t=Object(b.a)(e,2);return t[0],t[1],Object(be.jsxs)("div",{className:"App layout",children:[Object(be.jsx)(ge,{}),Object(be.jsx)("div",{className:"layout__info",children:Object(be.jsx)(Je,{})}),Object(be.jsx)("div",{className:"layout__canvas",children:Object(be.jsx)(ye,{})}),Object(be.jsx)("div",{className:"layout__download",children:Object(be.jsx)(Fe,{})}),Object(be.jsx)("div",{className:"layout__elements",children:Object(be.jsx)(Ve,{})}),Object(be.jsx)("div",{className:"layout__creator",children:Object(be.jsx)(Ae,{})}),Object(be.jsx)("div",{className:"layout__editor",children:Object(be.jsx)(He,{})})]})},Xe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,365)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),r(e),i(e)}))};n(359);o.a.render(Object(be.jsx)(i.a.StrictMode,{children:Object(be.jsx)(h.a,{store:B,children:Object(be.jsx)(Ge,{})})}),document.getElementById("root")),Xe()}},[[362,1,2]]]);
//# sourceMappingURL=main.61f97346.chunk.js.map